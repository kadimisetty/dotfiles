# Tmux Configuration file
# vim: foldmethod=marker:foldlevel=0:filetype=sh:


# BASIC SETTINGS {{{1
# Change Prefix from Ctrl-b to Ctrl-a because:
#  1. Closer to left Ctrl button.
#  2. C-b conflicts with Vim's "Move-back" command, although it still maps over vim's <c-a> increment.
#  3. Similar to `screen`'s prefix.
set -g prefix C-a
unbind C-b

# Hit `C-a` twice to switch to the last-window
bind C-a last-window
# Use `C-a a` to send `C-a` to running application (like Vim which uses <C-a> to increment)
bind-key a send-prefix

# Minimize tmux command waiting delay to not annoy programs like Vim
set -sg escape-time 0

# Start base window and pane index from 1 not 0
set-option -g base-index 1
setw -g pane-base-index 1

# Load from tmux conf (`~/.tmux.conf`)
bind r source-file ~/.tmux.conf \; display "RELOAD ~/.tmux.conf"


# SPLITS & MOVES {{{1
# Splitting panes with intuitive shortcuts
bind | split-window -h
bind - split-window -v

# Lowercase c to create from current path
bind c new-window -c "#{pane_current_path}"
# Uppercase C to create from tmux root
bind C new-window

# Move between panes like Vim
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# Cycle through the windows
bind -r C-h select-window -t :-
bind -r C-l select-window -t :+

# Tab/Shift-Tab(i.e. BTab) to move forward/backward in window list
bind -r Tab select-window -t :+
bind -r BTab select-window -t :-

# Resize panes easier with Vim bindings
bind H resize-pane -L 5
bind J resize-pane -D 5
bind K resize-pane -U 5
bind L resize-pane -R 5


# COPY MODE {{{1
# TODO: Copy mode needs cleanup
# Move through copy mode with Vi bindings
setw -g mode-keys vi
# Make Copy mode adhere to Vi bindings
# unbind [
# bind Escape copy-mode
# unbind p
# bind p paste-buffer
# bind -t vi-copy 'v' begin-selection
# bind -t vi-copy 'y' copy-selection


# APEARANCE {{{1
# Enable 256 colors
set -g default-terminal "screen-256color"

# COLORSCHEME {{{2
# THEME: Gruvbox Dark (medium)
set-option -g status "on"

# DEFAULT STATUSBAR COLOR
set-option -g status-style bg=colour237,fg=colour223 # bg=bg1, fg=fg1

# DEFAULT WINDOW TITLE COLORS
set-window-option -g window-status-style bg=colour214,fg=colour237 # bg=yellow, fg=bg1

# DEFAULT WINDOW WITH AN ACTIVITY ALERT
set-window-option -g window-status-activity-style bg=colour237,fg=colour248 # bg=bg1, fg=fg3

# ACTIVE WINDOW TITLE COLORS
set-window-option -g window-status-current-style bg=red,fg=colour237 # fg=bg1

# PANE BORDER
set-option -g pane-active-border-style fg=colour250 #fg2
set-option -g pane-border-style fg=colour237 #bg1

# MESSAGE INFOS
set-option -g message-style bg=colour239,fg=colour223 # bg=bg2, fg=fg1

# WRITING COMMANDS INACTIVE
set-option -g message-command-style bg=colour239,fg=colour223 # bg=fg3, fg=bg1

# PANE NUMBER DISPLAY
set-option -g display-panes-active-colour colour250 #fg2
set-option -g display-panes-colour colour237 #bg1

# CLOCK
set-window-option -g clock-mode-colour colour109 #blue


# STATUSLINE {{{2
# NOTE: Colors and status line settings have to be intermingled.
# QUICK REFERENCE:
# +------------------+---------------------------------------------------------------------------+
# | VARIABLE         |  DESCRIPTION                                                              |
# +------------------+---------------------------------------------------------------------------+
# | #H               |  Hostname of local host                                                   |
# | #h               |  Hostname of local host without the domain name #F of current window flag |
# | #I               |  Current window index                                                     |
# | #P               |  Current pane index                                                       |
# | #S               |  Current session name                                                     |
# | #T               |  Current window title                                                     |
# | #W               |  Current window name                                                      |
# | ##               |  A literal #                                                              |
# | #(shell-command) |  First line of the shell command’s output                                 |
# | #[attributes]    |  Color or attribute change                                                |
# +------------------+---------------------------------------------------------------------------+

# STATUS OPTIONS
set-option -g status-justify "left"

# BELL
set-window-option -g window-status-bell-style bg=colour167,fg=colour235 # bg=red, fg=bg

# LEFT STATUS
set-option -g status-left-style none
set-option -g status-left-length "80"
set-option -g status-left "#[bg=colour241,fg=colour248] #S #[bg=colour237,fg=colour241,nobold,noitalics,nounderscore]"

# WINDOW(MIDDLE) STATUS (Left aligned)
set-window-option -g window-status-separator ""
set-window-option -g window-status-current-format "#[bg=colour214,fg=colour237,nobold,noitalics,nounderscore]#[bg=colour214,fg=colour239] #I#[bg=colour214,fg=colour239,bold] #W#{?window_zoomed_flag,*Z,} #[bg=colour237,fg=colour214,nobold,noitalics,nounderscore]"
set-window-option -g window-status-format "#[bg=colour239,fg=colour237,noitalics]#[bg=colour239,fg=colour223] #I#[bg=colour239,fg=colour223] #W #[bg=colour237,fg=colour239,noitalics]"

# RIGHT STATUS
# Show if panes are synced
set-option -g status-right-length "16"
set-option -g status-right "#[bg=colour239,fg=colour223,noitalics]#{?pane_synchronized, ﬘ PANE SYNC ,}"
# TODO: Goal is to show current pane's working directory but using {pane_current_path} is
# inelgant because it is too long and has a delay when refreshing.
# set-option -g status-right-length "100"
# set-option -g status-right "#[bg=colour241,fg=colour248] #{pane_current_path} #[bg=colour237,fg=colour241,nobold,noitalics,nounderscore]"


# MISC {{{1
# Constrain window's size to current client's size limitations rather than the previous's
setw -g aggressive-resize on

# Enable mouse mode (for scrolling etc.)
setw -g mouse on

# Show activity
set -g monitor-activity on
set -g visual-activity on

# Refresh interval time. (default: 15)
set -g status-interval 10


# TMUX PLUGIN MANAGER {{{1
# NOTE: KEEP TPM SECTION AT BOTTOM
#
# Directins to install/update/uninstall tmux plugins with tpm: {{{2
# +-----------+----------------------------------------------------------------------------------+
# | INSTALL   | List in active tpm plugin section and in tmux run cmd `prefix+I` (I for install) |
# +-----------+----------------------------------------------------------------------------------+
# | UPDATE    | In tmux run `prefix+u` ( u for update)                                           |
# +-----------+----------------------------------------------------------------------------------+
# | UNINSTALL | Remove from list here and in tmux run `prefix+alt+u` (alt+u for uninstall)       |
# +-----------+----------------------------------------------------------------------------------+

# Active tpm Plugins {{{2
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'jaclu/tmux-menus'

# Start TPM(tmux plugin manager). NOTE: KEEP AT BOTTOM! {{{2
run '~/.tmux/plugins/tpm/tpm'
